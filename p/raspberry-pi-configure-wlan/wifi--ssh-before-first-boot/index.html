<!DOCTYPE html>
<html lang="en">
<head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Why Lots of Raspberry Pis are used for purposes requiring a wireless network connection. Configuring WLAN for the Pi requires a config file including the network&amp;rsquo;s name and access keys. To save time otherwise spent on connecting the Pi to a screen and keyboard or wired network to configure this, you can just create the config file before even booting the Pi for the first time. Here&amp;rsquo;s how that works."><meta name="author" content="Valentin Heidelberger">

<link rel="canonical" href="https://valh.io/p/raspberry-pi-configure-wlan/wifi--ssh-before-first-boot/">


<link rel="icon" type="image/x-icon" href="/img/favicon.ico" />
<title>Raspberry Pi: Configure WLAN/WiFi &#43; SSH before first boot</title>


<link rel="stylesheet" href="/css/styles.css" />


<link rel="stylesheet" href="/css/syntax.css" />


<link id="custom_css" href="/css/custom.css" rel="stylesheet">





<script src="/js/toggle_theme.js"></script>



<script src="https://use.fontawesome.com/releases/v5.15.3/js/all.js" crossorigin="anonymous"></script>

<link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css" />
<link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css" />

</head>
<body>
  
<nav class="navbar navbar-expand-lg navbar-light" id="mainNav">
  <div class="container px-4 px-lg-5">
    <a class="navbar-brand" href="/index.html">Valentin Heidelberger</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ms-auto py-4 py-lg-0">
        <li class="nav-item">
          <a class="nav-link px-lg-3 py-3 py-lg-4" title="Blog" href="/index.html">
            <span class="fa fa-book-open"></span>
            <span> Blog</span>
          </a>
        </li>
        
        
        <li class="nav-item">
          <a href="/search/" class="nav-link px-lg-3 py-3 py-lg-4" title="Search">
            <span class="fa fa-search nav-search-icon"></span>
            <span> Search</span>
          </a>
        </li>
        
        
          <li class="nav-item" onclick="toggle()">
            <a class="nav-link px-lg-3 py-3 py-lg-4" title="Toggle theme - this used to be persistent but due to the uncertainties of the EU cookie law I'm now refraining from using them to make the theme persistent">
              <span class="fa fa-adjust"></span>
              <span> Theme</span>
            </a>
          </li>
        
        
      </ul>
    </div>
  </div>
</nav>

  


  

<header class="masthead" style="background-image: url('/img/tags/raspberrypi.webp')">
  <div class="container position-relative px-4 px-lg-5">
    <div class="row gx-4 gx-lg-5 justify-content-center">
      <div class="col-md-10 col-lg-8 col-xl-7">
          
          
          <div class="post-heading">
            <h1>Raspberry Pi: Configure WLAN/WiFi &#43; SSH before first boot</h1>
            <h2 class="subheading"></h2>
            <span class="meta">Posted by Valentin Heidelberger on September 10, 2018</span>
            
            <span class="meta"> Tags:
              
              <a href="/tags/technology">
                    <i class="fa fa-tag"></i>
                    technology
                  </a>
                  
              <a href="/tags/linux">
                    <i class="fa fa-tag"></i>
                    linux
                  </a>
                  
              <a href="/tags/raspberrypi">
                    <i class="fa fa-tag"></i>
                    raspberrypi
                  </a>
                  
              <a href="/tags/homeserver">
                    <i class="fa fa-tag"></i>
                    homeserver
                  </a>
                  
                </span>
                
              </div>
              
        </div>
      </div>
    </div>
</header>
  

<article>
  
<aside id="custom_toc">
  <nav id="TableOfContents">
  <ul>
    <li><a href="#why">Why</a></li>
    <li><a href="#how">How</a>
      <ul>
        <li><a href="#wpa3--wpa2-mixed-network">WPA3 / WPA2 mixed network</a></li>
        <li><a href="#wpa2-only-network">WPA2-only network</a></li>
      </ul>
    </li>
    <li><a href="#pi-appears-on-network-but-login-via-ssh-doesnt-work">Pi appears on network but login via SSH doesn&rsquo;t work</a></li>
  </ul>
</nav>
</aside>

  <div class="container px-4 px-lg-5">
    <div class="row gx-4 gx-lg-5 justify-content-center">
      <div class="col-md-10 col-lg-8 col-xl-7">
        <h1 id="why">Why</h1>
<p>Lots of Raspberry Pis are used for purposes requiring a wireless network connection. Configuring WLAN for the Pi requires a config file including the network&rsquo;s name and access keys. To save time otherwise spent on connecting the Pi to a screen and keyboard or wired network to configure this, you can just create the config file before even booting the Pi for the first time. Here&rsquo;s how that works.</p>
<h1 id="how">How</h1>
<p><strong>Having flashed the Raspbian image onto your Pi</strong>, use your file explorer or terminal to move to a newly created partition called <strong>&ldquo;boot&rdquo;</strong> on the micro SD card.</p>
<p>Create a file called <strong>wpa_supplicant.conf</strong> in the root of that partition and paste the contents corresponding to the WPA version you&rsquo;re using.</p>
<p>Change the <em>country</em> parameter as well as the <em>ssid</em> and <em>psk</em> accordingly and save the file:</p>
<h2 id="wpa3--wpa2-mixed-network">WPA3 / WPA2 mixed network</h2>
<pre tabindex="0"><code class="language-conf" data-lang="conf">ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
update_config=1
country=US

network={
     ssid=&#34;Your network name/SSID&#34;
     psk=&#34;Your WPA security key&#34;
     key_mgmt=WPA-PSK-SHA256
     ieee80211w=2
}
</code></pre><h2 id="wpa2-only-network">WPA2-only network</h2>
<pre tabindex="0"><code class="language-conf" data-lang="conf">ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
update_config=1
country=US

network={
     ssid=&#34;Your network name/SSID&#34;
     psk=&#34;Your WPA security key&#34;
     key_mgmt=WPA-PSK
}
</code></pre><p>Having created the config for WLAN, create another (empty) file simply called <strong>ssh</strong> in the <strong>&ldquo;boot&rdquo;</strong> partition. If you&rsquo;re on Windows, make sure that both <strong>ssh</strong> and <strong>wpa_supplicant.conf</strong> don&rsquo;t have any other extension such as <em>.txt</em>.</p>
<p>Once the files are saved, eject the SD card safely, put it in your Pi and boot it up. You should be able to connect via SSH using the default user <em>pi</em> and password <em>raspberry</em> shortly after.</p>
<h1 id="pi-appears-on-network-but-login-via-ssh-doesnt-work">Pi appears on network but login via SSH doesn&rsquo;t work</h1>
<p>The process outlined in this article has always worked on my Raspberry Pi 4 and Zero W. On my old Pi 1 B+ however, it usually does not work - at least not without manual intervention!</p>
<p>The Pi 1 would appear on the network and be <em>reachable</em> via SSH but <em>login</em> was not possible with the usual pi / raspberry credentials. The problem being that this default user had not yet been properly created.</p>
<p>After having added the files as described above, I had to connect the Pi to a monitor, boot it up and wait&hellip;</p>
<p>It took at least 30 seconds after the systemd boot was finished for a prompt to appear - so be patient. The prompt then went straight into an interactive wizard which asked about language, keyboard layout and also created the user. Only after completing this wizard, I was able to login via SSH with the default user.</p>
<p>I&rsquo;m not sure why this is happening. On multiple tries, I also got a varying amount of steps in the wizard, sometimes more, sometimes fewer.</p>
<p>According to some folks in the Raspberry Pi forums, zeroing the SD card before flashing the Raspberry Pi OS image is supposed to help. In my case it didn&rsquo;t but I&rsquo;m still document the command for you to try.</p>
<p>Replace <strong>/dev/sdg</strong> with your SD card!</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo dd <span class="k">if</span><span class="o">=</span>/dev/zero <span class="nv">of</span><span class="o">=</span>/dev/sdg <span class="nv">bs</span><span class="o">=</span><span class="m">8192</span> <span class="nv">status</span><span class="o">=</span>progress
</span></span></code></pre></div>
        <br>
      </div>
    </div>
  </div>
</article>

  
<footer class="border-top">
  <div class="container px-4 px-lg-5">
    <div class="row gx-4 gx-lg-5 justify-content-center">
      <div class="col-md-10 col-lg-8 col-xl-7">
        <ul class="list-inline text-center">
          
          <li class="list-inline-item">
            <a href="/index.xml" target="_blank">
                <span class="fa-stack fa-lg">
                    <i class="far fa-circle fa-stack-2x"></i>
                    <i class="fa fa-rss fa-stack-1x"></i>
                </span>
            </a>
          </li>
          
          
          <li class="list-inline-item">
            <a href="https://github.com/va1entin" target="_blank">
              <span class="fa-stack fa-lg">
                <i class="far fa-circle fa-stack-2x"></i>
                <i class="fab fa-github fa-stack-1x"></i>
              </span>
            </a>
          </li>
          
          
        <li class="list-inline-item">
          <a href="https://gitlab.com/va1entin" target="_blank">
            <span class="fa-stack fa-lg">
              <i class="far fa-circle fa-stack-2x"></i>
              <i class="fab fa-gitlab fa-stack-1x"></i>
            </span>
          </a>
        </li>
        
        
        <li class="list-inline-item">
          <a href="https://www.linkedin.com/in/valentin-heidelberger-251769102" target="_blank">
            <span class="fa-stack fa-lg">
              <i class="far fa-circle fa-stack-2x"></i>
              <i class="fab fa-linkedin fa-stack-1x"></i>
            </span>
          </a>
        </li>
        
        
        <li class="list-inline-item">
          <a href="https://www.xing.com/profile/Valentin_Heidelberger" target="_blank">
            <span class="fa-stack fa-lg">
              <i class="far fa-circle fa-stack-2x"></i>
              <i class="fab fa-xing fa-stack-1x"></i>
            </span>
          </a>
        </li>
        
        <div class="small text-center text-muted fst-italic">
        
            <br>
            <br>
            <a rel="license" href="http://creativecommons.org/licenses/by/4.0/" target="_blank">CC-BY 4.0 International</a> Valentin Heidelberger 2017 - 2022
            <br>
            This applies to the contents of my blog and other texts on this site only.
            <br>
            <a href="/terms-of-use">Terms of use</a>
            <br>
            Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a>
        
        </div>
        </ul>
        <br>
        <br>
      </div>
    </div>
  </div>
</footer>

  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"></script>
  
  <script src="/js/scripts.js"></script>
</body>
</html>