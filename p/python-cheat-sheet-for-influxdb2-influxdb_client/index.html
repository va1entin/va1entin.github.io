<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=description content="Setup InfluxDB test instance with Docker docker run -d -p 8086:8086 --name influxdb influxdb This command pulls the latest InfluxDB image from Docker Hub, runs it with the name influxdb and makes the default port 8086 available on localhost. Once the container is up and running, we need to setup InfluxDB before we can use it.
Open a shell in the InfluxDB container:
docker exec -it influxdb bash Start the interactive setup wizard by running influx setup. The wizard will ask you to provide initial admin credentials, your first organization, your first bucket and a retention period for it.
"><meta name=author content="Valentin Heidelberger"><link rel=canonical href=https://valh.io/p/python-cheat-sheet-for-influxdb2-influxdb_client/><link rel=icon type=image/x-icon href=/img/favicon.ico><title>Python cheat sheet for InfluxDB2 (influxdb_client)</title><link rel=stylesheet href=/css/styles.css><link rel=stylesheet href=/css/syntax.css><link id=custom_css href=/css/custom.css rel=stylesheet><link id=dark_css href=/css/dark.css rel=stylesheet><link href=/css/webfonts/fontawesome.min.css rel=stylesheet><link href=/css/webfonts/brands.min.css rel=stylesheet><link href=/css/webfonts/solid.min.css rel=stylesheet><link href=/css/webfonts/regular.min.css rel=stylesheet></head><body><nav class="navbar navbar-expand-lg navbar-light" id=mainNav><div class="container px-4 px-lg-5"><a class=navbar-brand href=/index.html><picture><source srcset=/img/logo_small_dark.webp media="(max-width: 991px) and (prefers-color-scheme: light)"><source srcset=/img/logo_small.webp media="(max-width: 991px) and (prefers-color-scheme: dark)"><source srcset=/img/logo_small.webp media="(min-width: 992px)"><img class=navbar-logo>
</picture>Valentin Heidelberger
</a><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarResponsive aria-controls=navbarResponsive aria-expanded=false aria-label="Toggle navigation">
Menu
<i class="fas fa-bars"></i></button><div class="collapse navbar-collapse" id=navbarResponsive><ul class="navbar-nav ms-auto py-4 py-lg-0"><li class=nav-item><a class="nav-link px-lg-3 py-3 py-lg-4 active" title=Blog href=/index.html><span class="fa fa-book-open"></span>
<span>Blog</span></a></li><li class=nav-item><a href=/search/ class="nav-link px-lg-3 py-3 py-lg-4" title=Search><span class="fa fa-search nav-search-icon"></span>
<span>Search</span></a></li><li class=nav-item><a class="nav-link px-lg-3 py-3 py-lg-4" title="About me" href=/about-me><span class="fas fa-user"></span>
<span>About me</span></a></li></ul></div></div></nav><header class=masthead style=background-image:url(/img/tags/data.webp)><div class="container position-relative px-4 px-lg-5"><div class="row gx-4 gx-lg-5 justify-content-center"><div class="col-md-10 col-lg-8 col-xl-7"><div class=post-heading><h1>Python cheat sheet for InfluxDB2 (influxdb_client)</h1><h2 class=subheading></h2><span class=meta>Posted on March 2, 2021</span>
<span class=meta>Tags:
<a href=/tags/data>#data
</a><a href=/tags/docker>#docker
</a><a href=/tags/technology>#technology
</a><a href=/tags/cheatsheet>#cheatsheet
</a><a href=/tags/linux>#linux</a></span></div></div></div></div></header><article class=mb4><aside id=custom_toc><nav id=TableOfContents><ul><li><a href=#setup-influxdb-test-instance-with-docker>Setup InfluxDB test instance with Docker</a></li><li><a href=#install-influxdb_client-with-pip>Install influxdb_client with pip</a></li><li><a href=#connection-setup-required-for-all-steps-below>Connection setup (required for all steps below)</a></li><li><a href=#test-connection>Test connection</a></li><li><a href=#query-data>Query data</a><ul><li><a href=#get-query-api>Get query api</a></li><li><a href=#create-a-query>Create a query</a></li><li><a href=#run-a-query>Run a query</a></li><li><a href=#get-dict-from-data-point>Get dict from data point</a></li></ul></li><li><a href=#write-data>Write data</a><ul><li><a href=#get-write-api>Get write api</a></li><li><a href=#write-a-data-point>Write a data point</a></li></ul></li><li><a href=#buckets>Buckets</a><ul><li><a href=#get-all-buckets-in-current-org>Get all buckets in current org</a></li><li><a href=#get-all-bucket-names-in-current-org>Get all bucket names in current org</a></li><li><a href=#get-bucket-object-by-bucket-name>Get bucket object by bucket name</a></li><li><a href=#create-bucket>Create bucket</a></li><li><a href=#delete-bucket>Delete bucket</a></li></ul></li><li><a href=#organizations>Organizations</a><ul><li><a href=#get-all-organizations>Get all organizations</a></li><li><a href=#get-organization-id>Get organization id</a></li><li><a href=#create-organization>Create organization</a></li><li><a href=#delete-organization>Delete organization</a></li></ul></li></ul></nav></aside><div class="container px-4 px-lg-5"><div class="row gx-4 gx-lg-5 justify-content-center"><div class="col-md-10 col-lg-8 col-xl-7"><h1 id=setup-influxdb-test-instance-with-docker>Setup InfluxDB test instance with Docker</h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker run -d -p 8086:8086 --name influxdb influxdb
</span></span></code></pre></div><p>This command pulls the latest InfluxDB image from Docker Hub, runs it with the name <code>influxdb</code> and makes the default port <code>8086</code> available on <code>localhost</code>.
Once the container is up and running, we need to setup InfluxDB before we can use it.</p><p>Open a shell in the InfluxDB container:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker <span class=nb>exec</span> -it influxdb bash
</span></span></code></pre></div><p>Start the interactive setup wizard by running <code>influx setup</code>.
The wizard will ask you to provide initial admin credentials, your first organization, your first bucket and a retention period for it.</p><p>I have created a user <code>val</code> with a password (invisible in the wizard), an organization called <code>my_org</code> and a bucket <code>my_bucket</code>:</p><pre tabindex=0><code>root@d8818fce8c18:/# influx setup
Welcome to InfluxDB 2.0!
Please type your primary username: val

Please type your password:

Please type your password again:

Please type your primary organization name: my_org

Please type your primary bucket name: my_bucket

Please type your retention period in hours.
Or press ENTER for infinite.:
</code></pre><p>Lastly, the wizard will ask you to confirm your inputs:</p><pre tabindex=0><code>You have entered:
  Username:          val
  Organization:      my_org
  Bucket:            my_bucket
  Retention Period:  infinite
Confirm? (y/n): y

Config default has been stored in /root/.influxdbv2/configs.
User    Organization    Bucket
val     my_org          my_bucket
</code></pre><p>One advantage of performing the setup using the CLI is that it writes your initial admin user&rsquo;s credentials to a config file, allowing you to manage your InfluxDB instance using the <code>influx</code> CLI directly with admin privileges.</p><p>We&rsquo;ll use this to get our initial admin user&rsquo;s token, which we&rsquo;ll use later to set up the connection to InfluxDB in Python.</p><p><code>influx auth list</code> gives us a list of existing users and tokens. For the sake of readability I&rsquo;m using <code>awk</code> to limit output to just the token.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@d8818fce8c18:/# influx auth list <span class=p>|</span> awk <span class=s1>&#39;FNR&gt;1 {print $4}&#39;</span>
</span></span><span class=line><span class=cl><span class=nv>_U13AGG9YWojXjuh2OAUKqtsA20Fual8Vt_aVTvdJ1eWUJu0pH85ppkCEM3lL5hEpNS_8vPRh7nik8QkEvfZFA</span><span class=o>==</span>
</span></span></code></pre></div><p>Save your token somewhere to have it at hand for the <a href=#connection-setup>Connection setup</a> step.</p><p>Now, we can exit the container shell:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@d8818fce8c18:/# <span class=nb>exit</span>
</span></span></code></pre></div><br><hr><br><h1 id=install-influxdb_client-with-pip>Install influxdb_client with pip</h1><p>Depending on your setup and linux distro you might want to do this with the distro&rsquo;s package manager.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pip3 install influxdb-client <span class=c1># NOT &#39;influx-client&#39; or &#39;influxdb&#39;!</span>
</span></span></code></pre></div><br><hr><br><h1 id=connection-setup-required-for-all-steps-below>Connection setup (required for all steps below)</h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>influxdb_client</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>my_client</span> <span class=o>=</span> <span class=n>influxdb_client</span><span class=o>.</span><span class=n>InfluxDBClient</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=n>url</span><span class=o>=</span><span class=n>my_url</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>token</span><span class=o>=</span><span class=n>my_token</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>org</span><span class=o>=</span><span class=s1>&#39;my_org&#39;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></div><p>To connect to the docker test instance, use the token obtained after the <a href=#setup-influxdb-test-instance-with-docker>InfluxDB setup</a>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>influxdb_client</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>my_client</span> <span class=o>=</span> <span class=n>influxdb_client</span><span class=o>.</span><span class=n>InfluxDBClient</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=n>url</span><span class=o>=</span><span class=s1>&#39;http://localhost:8086&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>token</span><span class=o>=</span><span class=s1>&#39;_U13AGG9YWojXjuh2OAUKqtsA20Fual8Vt_aVTvdJ1eWUJu0pH85ppkCEM3lL5hEpNS_8vPRh7nik8QkEvfZFA==&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>org</span><span class=o>=</span><span class=s1>&#39;my_org&#39;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></div><br><hr><br><h1 id=test-connection>Test connection</h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>my_client</span><span class=o>.</span><span class=n>ready</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=s1>&#39;started&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=mi>2021</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>23</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>29</span><span class=p>,</span> <span class=mi>916723</span><span class=p>,</span> <span class=n>tzinfo</span><span class=o>=</span><span class=n>tzlocal</span><span class=p>()),</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;status&#39;</span><span class=p>:</span> <span class=s1>&#39;ready&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=s1>&#39;up&#39;</span><span class=p>:</span> <span class=s1>&#39;47m11.068245257s&#39;</span><span class=p>}</span>
</span></span></code></pre></div><br><hr><br><h1 id=query-data>Query data</h1><br><h2 id=get-query-api>Get query api</h2><p>Firstly, obtain a query API instance:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>influxdb_query_api</span> <span class=o>=</span> <span class=n>my_client</span><span class=o>.</span><span class=n>query_api</span><span class=p>()</span>
</span></span></code></pre></div><br><h2 id=create-a-query>Create a query</h2><p>Check out the official <a href=https://docs.influxdata.com/influxdb/v2.0/query-data/get-started/>documentation</a> for the Flux query language to learn how to build queries.</p><p>This is a very basic example getting all data points of the measurement <code>my_measurement</code> from the last 100 minutes in <code>my_bucket</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>query</span> <span class=o>=</span> <span class=s1>&#39;from(bucket:&#34;my_bucket&#34;)</span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s1>|&gt; range(start: -100m)</span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s1>|&gt; filter(fn:(r) =&gt; r._measurement == &#34;my_measurement&#34;)&#39;</span>
</span></span></code></pre></div><br><h2 id=run-a-query>Run a query</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=n>influxdb_query_api</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=n>org</span><span class=o>=</span><span class=s1>&#39;my_org&#39;</span><span class=p>,</span> <span class=n>query</span><span class=o>=</span><span class=n>query</span><span class=p>)</span>
</span></span></code></pre></div><p>See the official <a href=https://docs.influxdata.com/influxdb/cloud/tools/client-libraries/python/#query-data-from-influxdb-with-python>InfluxDB documentation</a> for ways to use the result data including an example script.</p><br><h2 id=get-dict-from-data-point>Get dict from data point</h2><p>For this example I have created a data point as shown <a href=#write-a-data-point>here</a>.</p><p>Assuming you have a <code>influxdb_client.Point</code> object, a dict representation of it&rsquo;s contents can be obtained like so:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>point</span><span class=o>.</span><span class=vm>__dict__</span>
</span></span></code></pre></div><p>The output will look something like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=p>{</span><span class=s1>&#39;_tags&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;my_tag&#39;</span><span class=p>:</span> <span class=s1>&#39;my_value&#39;</span><span class=p>},</span> <span class=s1>&#39;_fields&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;my_first_field&#39;</span><span class=p>:</span> <span class=s1>&#39;my second field value&#39;</span><span class=p>},</span> <span class=s1>&#39;_name&#39;</span><span class=p>:</span> <span class=s1>&#39;my_measurement&#39;</span><span class=p>,</span> <span class=s1>&#39;_time&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=p>(</span><span class=mi>2021</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>13</span><span class=p>,</span> <span class=mi>54</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>692337</span><span class=p>),</span> <span class=s1>&#39;_write_precision&#39;</span><span class=p>:</span> <span class=s1>&#39;ms&#39;</span><span class=p>}</span>
</span></span></code></pre></div><br><hr><br><h1 id=write-data>Write data</h1><br><h2 id=get-write-api>Get write api</h2><p>You need to specify which <code>write option</code> the client shall use when creating the instance.
At the time of writing this post the possible write options are: synchronous, asynchronous, batching</p><p>There are shortcuts for <code>synchronous</code> and <code>asynchronous</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>influxdb_client</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>write_api</span><span class=o>.</span><span class=n>SYNCHRONOUS</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>influxdb_client</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>write_api</span><span class=o>.</span><span class=n>ASYNCHRONOUS</span>
</span></span></code></pre></div><p><code>batching</code> is accessible by creating an <code>WriteOptions</code> instance and passing it the <code>WriteType</code> of <code>batching</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>influxdb_client</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>write_api</span><span class=o>.</span><span class=n>WriteOptions</span><span class=p>(</span><span class=n>influxdb_client</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>write_api</span><span class=o>.</span><span class=n>WriteType</span><span class=o>.</span><span class=n>batching</span><span class=p>)</span>
</span></span></code></pre></div><p>Using the <code>write option</code>, that you&rsquo;ve decided for, you can get a <code>write api</code> instance:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>influxdb_write_api</span> <span class=o>=</span> <span class=n>my_client</span><span class=o>.</span><span class=n>write_api</span><span class=p>(</span><span class=n>write_options</span><span class=o>=</span><span class=n>influxdb_client</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>write_api</span><span class=o>.</span><span class=n>SYNCHRONOUS</span><span class=p>)</span>
</span></span></code></pre></div><br><h2 id=write-a-data-point>Write a data point</h2><p>A data point is created from an <code>influxdb_client.Point</code> object. To put our data in, we can either:</p><ul><li>use various functions of the Point object itself</li><li>pass it a dict</li></ul><p>I prefer using a dict, because I think it&rsquo;s much more readable and easy to understand. This might be especially useful for people who know Python but are not perfectly familiar with how <code>influxdb_client.Point</code> objects work in detail.</p><p><code>my_time</code> must be a timestamp, that InfluxDB understands.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>point</span> <span class=o>=</span> <span class=n>influxdb_client</span><span class=o>.</span><span class=n>Point</span><span class=o>.</span><span class=n>from_dict</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;measurement&#39;</span><span class=p>:</span> <span class=s1>&#39;my_measurement&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;tags&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;my_tag&#39;</span><span class=p>:</span> <span class=s1>&#39;my_value&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;fields&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;my_first_field&#39;</span><span class=p>:</span> <span class=s1>&#39;my first field value&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;my_first_field&#39;</span><span class=p>:</span> <span class=s1>&#39;my second field value&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;time&#39;</span><span class=p>:</span> <span class=s1>&#39;my_time&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=n>influxdb_client</span><span class=o>.</span><span class=n>WritePrecision</span><span class=o>.</span><span class=n>MS</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>influxdb_write_api</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s1>&#39;my_bucket&#39;</span><span class=p>,</span> <span class=s1>&#39;my_org&#39;</span><span class=p>,</span> <span class=n>point</span><span class=p>)</span>
</span></span></code></pre></div><p>For example, you can use the <code>datetime</code> module:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>datetime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>point</span> <span class=o>=</span> <span class=n>influxdb_client</span><span class=o>.</span><span class=n>Point</span><span class=o>.</span><span class=n>from_dict</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;measurement&#39;</span><span class=p>:</span> <span class=s1>&#39;my_measurement&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;tags&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;my_tag&#39;</span><span class=p>:</span> <span class=s1>&#39;my_value&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;fields&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;my_first_field&#39;</span><span class=p>:</span> <span class=s1>&#39;my first field value&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;my_first_field&#39;</span><span class=p>:</span> <span class=s1>&#39;my second field value&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;time&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=n>influxdb_client</span><span class=o>.</span><span class=n>WritePrecision</span><span class=o>.</span><span class=n>MS</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>influxdb_write_api</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s1>&#39;my_bucket&#39;</span><span class=p>,</span> <span class=s1>&#39;my_org&#39;</span><span class=p>,</span> <span class=n>point</span><span class=p>)</span>
</span></span></code></pre></div><br><hr><br><h1 id=buckets>Buckets</h1><p>Firstly, obtain a buckets API instance:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>influxdb_buckets_api</span> <span class=o>=</span> <span class=n>my_client</span><span class=o>.</span><span class=n>buckets_api</span><span class=p>()</span>
</span></span></code></pre></div><br><h2 id=get-all-buckets-in-current-org>Get all buckets in current org</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>bucket_objects</span> <span class=o>=</span> <span class=n>influxdb_buckets_api</span><span class=o>.</span><span class=n>find_buckets</span><span class=p>()</span>
</span></span></code></pre></div><br><h2 id=get-all-bucket-names-in-current-org>Get all bucket names in current org</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>bucket_objects</span> <span class=o>=</span> <span class=n>influxdb_buckets_api</span><span class=o>.</span><span class=n>find_buckets</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>bucket_names</span> <span class=o>=</span> <span class=p>[</span><span class=n>bucket</span><span class=o>.</span><span class=n>name</span> <span class=k>for</span> <span class=n>bucket</span> <span class=ow>in</span> <span class=n>bucket_objects</span><span class=o>.</span><span class=n>buckets</span><span class=p>]</span>
</span></span></code></pre></div><br><h2 id=get-bucket-object-by-bucket-name>Get bucket object by bucket name</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>my_bucket</span> <span class=o>=</span> <span class=n>influxdb_buckets_api</span><span class=o>.</span><span class=n>find_bucket_by_name</span><span class=p>(</span><span class=s1>&#39;my_bucket&#39;</span><span class=p>)</span>
</span></span></code></pre></div><br><h2 id=create-bucket>Create bucket</h2><p>See <a href=#get-org-id>this section</a> for getting <code>my_org_id</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>new_bucket</span> <span class=o>=</span> <span class=n>influxdb_client</span><span class=o>.</span><span class=n>domain</span><span class=o>.</span><span class=n>bucket</span><span class=o>.</span><span class=n>Bucket</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=n>name</span><span class=o>=</span><span class=s1>&#39;my_new_bucket&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>retention_rules</span><span class=o>=</span><span class=p>[],</span>
</span></span><span class=line><span class=cl>  <span class=n>org_id</span><span class=o>=</span><span class=n>my_org_id</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>influxdb_buckets_api</span><span class=o>.</span><span class=n>create_bucket</span><span class=p>(</span><span class=n>new_bucket</span><span class=p>)</span>
</span></span></code></pre></div><br><h2 id=delete-bucket>Delete bucket</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>bucket</span> <span class=o>=</span> <span class=n>influxdb_buckets_api</span><span class=o>.</span><span class=n>find_bucket_by_name</span><span class=p>(</span><span class=s1>&#39;my_bucket&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>influxdb_buckets_api</span><span class=o>.</span><span class=n>delete_bucket</span><span class=p>(</span><span class=n>bucket</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
</span></span></code></pre></div><br><hr><br><h1 id=organizations>Organizations</h1><p>Firstly, obtain a organizations API instance:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>influxdb_org_api</span> <span class=o>=</span> <span class=n>influxdb_client</span><span class=o>.</span><span class=n>OrganizationsApi</span><span class=p>(</span><span class=n>my_client</span><span class=p>)</span>
</span></span></code></pre></div><br><h2 id=get-all-organizations>Get all organizations</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>orgs</span> <span class=o>=</span> <span class=n>influxdb_org_api</span><span class=o>.</span><span class=n>find_organizations</span><span class=p>()</span>
</span></span></code></pre></div><br><h2 id=get-organization-id>Get organization id</h2><p>Look for your organization in the list of all organizations <code>orgs</code>, which you obtained in the previous step.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>for</span> <span class=n>org</span> <span class=ow>in</span> <span class=n>orgs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=n>org</span><span class=o>.</span><span class=n>name</span> <span class=o>==</span> <span class=s1>&#39;my_org&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>my_org_id</span> <span class=o>=</span> <span class=n>org</span><span class=o>.</span><span class=n>id</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>my_org_id</span><span class=p>)</span>
</span></span></code></pre></div><br><h2 id=create-organization>Create organization</h2><p><code>my_new_org</code> will be the new organization&rsquo;s name.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>influxdb_org_api</span><span class=o>.</span><span class=n>create_organization</span><span class=p>(</span><span class=s1>&#39;my_new_org&#39;</span><span class=p>)</span>
</span></span></code></pre></div><br><h2 id=delete-organization>Delete organization</h2><p>To delete an organization, you need it&rsquo;s ID. See <a href=#get-organization-id>Get organization id</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>influxdb_org_api</span><span class=o>.</span><span class=n>delete_organization</span><span class=p>(</span><span class=n>my_org_id</span><span class=p>)</span>
</span></span></code></pre></div><br><br></div></div></div></article><footer class=border-top><div class="container px-4 px-lg-5"><div class="row gx-4 gx-lg-5 justify-content-center"><div class="col-md-10 col-lg-8 col-xl-7"><ul class="list-inline text-center"><li class=list-inline-item><a href=/index.xml target=_blank><i style=margin:.25em class="fa fa-rss fa-2xl"></i></a></li><li class=list-inline-item><a href=https://github.com/va1entin target=_blank><i style=margin:.25em class="fab fa-github fa-2xl"></i></a></li><li class=list-inline-item><a href=https://gitlab.com/va1entin target=_blank><i style=margin:.25em class="fab fa-gitlab fa-2xl"></i></a></li><li class=list-inline-item><a href=https://www.linkedin.com/in/va1entin target=_blank><i style=margin:.25em class="fab fa-linkedin fa-2xl"></i></a></li><div class="small text-center text-muted fst-italic"><br><br><a rel=license href=http://creativecommons.org/licenses/by/4.0/ target=_blank>CC-BY 4.0 International</a> Valentin Heidelberger 2017 - 2024<br>This applies to the contents of my blog and other texts on this site only.<br><a href=/terms-of-use>Terms of use</a><br>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a></div></ul><br><br></div></div></div></footer><script src=/js/bootstrap.bundle.min.js></script><script src=/js/scripts.js></script></body></html>